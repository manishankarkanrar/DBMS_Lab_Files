--GROUP A


CREATE SEQUENCE SQ_EMP
START WITH 101
INCREMENT BY 1
;

CREATE TABLE DEPARTMENT (
	DEPTID 	 VARCHAR2(5)   PRIMARY KEY,
	DNAME	 VARCHAR2(15)  NOT NULL,
	CHECK(DEPTID LIKE 'D%')
);
DESC DEPARTMENT;

INSERT INTO DEPARTMENT VALUES ('D1', 'SALES');
INSERT INTO DEPARTMENT VALUES ('D2', 'MARKETING');
INSERT INTO DEPARTMENT VALUES ('D3', 'FINANCE');

SELECT * FROM DEPARTMENT;

CREATE TABLE EMPLOYEE (
	EID 	  	NUMBER(3)   PRIMARY KEY,
	ENAME	  	VARCHAR2(15),
	DEPTID		VARCHAR2(5),
	DESIGNATION  	VARCHAR2(10),
	SALARY		NUMBER(6),
	DOJ		DATE,
	FOREIGN KEY(DEPTID) REFERENCES DEPARTMENT(DEPTID),
	CHECK(SALARY > 10000)
);
DESC EMPLOYEE;

INSERT INTO EMPLOYEE VALUES (SQ_EMP.NEXTVAL, 'SUDHA', 'D2', 'CLERK', 20000, '01-APR-2010');
INSERT INTO EMPLOYEE VALUES (SQ_EMP.NEXTVAL, 'DAVID', 'D1', 'MANAGER', 50000, '18-FEB-2018');
INSERT INTO EMPLOYEE VALUES (SQ_EMP.NEXTVAL, 'PREETHI', 'D3', 'CLERK', 35000, '13-JUN-2011');
INSERT INTO EMPLOYEE VALUES (SQ_EMP.NEXTVAL, 'KIRAN', 'D1', 'SALESMAN', 20000, '7-MAR-2014');
INSERT INTO EMPLOYEE VALUES (SQ_EMP.NEXTVAL, 'MEENAL', 'D2', 'CLERK', 50000, '9-DEC-2011');
INSERT INTO EMPLOYEE VALUES (SQ_EMP.NEXTVAL, 'SUNITHA', 'D3', 'MANAGER', 60000, '25-SEP-2018');
INSERT INTO EMPLOYEE VALUES (SQ_EMP.NEXTVAL, 'AKHIL', 'D3', 'CLERK', 25000, '14-FEB-2016');
INSERT INTO EMPLOYEE VALUES (SQ_EMP.NEXTVAL, 'SUSHMA', 'D2', 'MANAGER', 45000, '31-JAN-2012');

SELECT * FROM EMPLOYEE;

--GROUP B

--Q1
SELECT ENAME, DESIGNATION FROM EMPLOYEE
WHERE (SALARY > (SELECT AVG(SALARY) FROM EMPLOYEE)) ;

--Q2
SELECT D.DNAME, E.ENAME, E.DESIGNATION, E.SALARY
FROM EMPLOYEE E, DEPARTMENT D
WHERE (E.DEPTID=D.DEPTID)
ORDER BY D.DNAME, E.SALARY;

--Q3 
SELECT E.ENAME, E.DESIGNATION
FROM EMPLOYEE E, DEPARTMENT D
WHERE (E.DEPTID=D.DEPTID AND D.DNAME='SALES' AND E.DESIGNATION='CLERK');

--Q4 
SELECT E.ENAME, E.DESIGNATION
FROM EMPLOYEE E, DEPARTMENT D
WHERE (E.DEPTID=D.DEPTID AND D.DNAME='SALES' AND EXTRACT(MONTH FROM DOJ)=2);

--Q5
SELECT EID, ENAME, DEPTID, (EXTRACT(YEAR FROM SYSDATE) - EXTRACT(YEAR FROM DOJ)) "EXPERIENCE"
FROM EMPLOYEE;



